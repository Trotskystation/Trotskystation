<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8" />
    <base href="../../" />
    <link rel="stylesheet" href="dmdoc.css" />
    <title>&#x2F;obj&#x2F;item&#x2F;energy_harvester - Yogstation 13</title>
</head>
<body>
<header>
    <a href="index.html">Yogstation 13</a> -
    <a href="index.html#modules">Modules</a> -
    <a href="index.html#types">Types</a>
 &mdash; <a href="obj/item/energy_harvester.html#var">Var Details</a> - <a href="obj/item/energy_harvester.html#proc">Proc Details</a></header>
<main>
<h1>Energy Harvesting Module <aside>/<a href="obj.html">obj</a>/<a href="obj/item/energy_harvester.html">item/energy_harvester</a></aside>
        
    
            <a href="https://github.com/Trotskystation/Trotskystation/blob/21b53b49b9515365eab7fd48c7dc12c6bae7cdd2/code/modules/power/energyharvester.dm#L8">
        <img src="git.png" width="16" height="16" title="code&#x2F;modules&#x2F;power&#x2F;energyharvester.dm 8"/></a></h1>

<table class="summary" cellspacing="0"><tr><td colspan="2"><h2>Vars</h2></td></tr>
            <tr><th><a href="obj/item/energy_harvester.html#var/PN">PN</a></th><td>cached powernet, assigned when attached to a wirenet with a powernet</td></tr>
            <tr><th><a href="obj/item/energy_harvester.html#var/accumulated_power">accumulated_power</a></th><td>amount of power consumed by the harvester, incremented every tick and reset every budget cycle</td></tr>
            <tr><th><a href="obj/item/energy_harvester.html#var/input_energy">input_energy</a></th><td>energy inputted into machine</td></tr>
            <tr><th><a href="obj/item/energy_harvester.html#var/last_accumulated_power">last_accumulated_power</a></th><td>last amount of energy transmitted before being reset by budget cycle, so CE can check if his engine modifications are making more power</td></tr>
            <tr><th><a href="obj/item/energy_harvester.html#var/last_payout">last_payout</a></th><td>last payout recieved, so CE can gleefully rub his hands every time the paycheck comes in</td></tr>
            <tr><th><a href="obj/item/energy_harvester.html#var/last_tick">last_tick</a></th><td>stores last REALTIMEOFDAY tick. SSEconomy runs off of that, don't see why this one shouldn't too</td></tr>
            <tr><th><a href="obj/item/energy_harvester.html#var/manual_power_setting">manual_power_setting</a></th><td>manual power setting to limit the maximum draw of the machine</td></tr>
            <tr><th><a href="obj/item/energy_harvester.html#var/manual_switch">manual_switch</a></th><td>manual on/off switch</td></tr>
            <tr><th><a href="obj/item/energy_harvester.html#var/ui_x">ui_x</a></th><td>tgui width</td></tr>
            <tr><th><a href="obj/item/energy_harvester.html#var/ui_y">ui_y</a></th><td>tgui height</td></tr><tr><td colspan="2"><h2>Procs</h2></td></tr>
            <tr><th><a href="obj/item/energy_harvester.html#proc/attackby">attackby</a></th><td>Standard checks for connecting a machine to an open cable node</td></tr>
            <tr><th><a href="obj/item/energy_harvester.html#proc/calculateMoney">calculateMoney</a></th><td></td></tr>
            <tr><th><a href="obj/item/energy_harvester.html#proc/connect_to_network">connect_to_network</a></th><td>links this to SSeconomy so it can be added to the budget cycle calculations
for when a mapper connects it to the power room roundstart</td></tr>
            <tr><th><a href="obj/item/energy_harvester.html#proc/disconnect_from_network">disconnect_from_network</a></th><td></td></tr>
            <tr><th><a href="obj/item/energy_harvester.html#proc/payout">payout</a></th><td></td></tr>
            <tr><th><a href="obj/item/energy_harvester.html#proc/process">process</a></th><td></td></tr></table>
    <h2 id="var">Var Details</h2><h3 id="var/PN"><aside class="declaration">var </aside>PN
            <aside>&ndash; /<a href="datum.html">datum</a>/<a href="datum/powernet.html">powernet</a></aside>
        
    
            <a href="https://github.com/Trotskystation/Trotskystation/blob/21b53b49b9515365eab7fd48c7dc12c6bae7cdd2/code/modules/power/energyharvester.dm#L27">
        <img src="git.png" width="16" height="16" title="code&#x2F;modules&#x2F;power&#x2F;energyharvester.dm 27"/></a></h3>
        <p>cached powernet, assigned when attached to a wirenet with a powernet</p><h3 id="var/accumulated_power"><aside class="declaration">var </aside>accumulated_power
            <aside>&ndash; </aside>
        
    
            <a href="https://github.com/Trotskystation/Trotskystation/blob/21b53b49b9515365eab7fd48c7dc12c6bae7cdd2/code/modules/power/energyharvester.dm#L23">
        <img src="git.png" width="16" height="16" title="code&#x2F;modules&#x2F;power&#x2F;energyharvester.dm 23"/></a></h3>
        <p>amount of power consumed by the harvester, incremented every tick and reset every budget cycle</p><h3 id="var/input_energy"><aside class="declaration">var </aside>input_energy
            <aside>&ndash; </aside>
        
    
            <a href="https://github.com/Trotskystation/Trotskystation/blob/21b53b49b9515365eab7fd48c7dc12c6bae7cdd2/code/modules/power/energyharvester.dm#L33">
        <img src="git.png" width="16" height="16" title="code&#x2F;modules&#x2F;power&#x2F;energyharvester.dm 33"/></a></h3>
        <p>energy inputted into machine</p><h3 id="var/last_accumulated_power"><aside class="declaration">var </aside>last_accumulated_power
            <aside>&ndash; </aside>
        
    
            <a href="https://github.com/Trotskystation/Trotskystation/blob/21b53b49b9515365eab7fd48c7dc12c6bae7cdd2/code/modules/power/energyharvester.dm#L39">
        <img src="git.png" width="16" height="16" title="code&#x2F;modules&#x2F;power&#x2F;energyharvester.dm 39"/></a></h3>
        <p>last amount of energy transmitted before being reset by budget cycle, so CE can check if his engine modifications are making more power</p><h3 id="var/last_payout"><aside class="declaration">var </aside>last_payout
            <aside>&ndash; </aside>
        
    
            <a href="https://github.com/Trotskystation/Trotskystation/blob/21b53b49b9515365eab7fd48c7dc12c6bae7cdd2/code/modules/power/energyharvester.dm#L37">
        <img src="git.png" width="16" height="16" title="code&#x2F;modules&#x2F;power&#x2F;energyharvester.dm 37"/></a></h3>
        <p>last payout recieved, so CE can gleefully rub his hands every time the paycheck comes in</p><h3 id="var/last_tick"><aside class="declaration">var </aside>last_tick
            <aside>&ndash; </aside>
        
    
            <a href="https://github.com/Trotskystation/Trotskystation/blob/21b53b49b9515365eab7fd48c7dc12c6bae7cdd2/code/modules/power/energyharvester.dm#L25">
        <img src="git.png" width="16" height="16" title="code&#x2F;modules&#x2F;power&#x2F;energyharvester.dm 25"/></a></h3>
        <p>stores last REALTIMEOFDAY tick. SSEconomy runs off of that, don't see why this one shouldn't too</p><h3 id="var/manual_power_setting"><aside class="declaration">var </aside>manual_power_setting
            <aside>&ndash; </aside>
        
    
            <a href="https://github.com/Trotskystation/Trotskystation/blob/21b53b49b9515365eab7fd48c7dc12c6bae7cdd2/code/modules/power/energyharvester.dm#L29">
        <img src="git.png" width="16" height="16" title="code&#x2F;modules&#x2F;power&#x2F;energyharvester.dm 29"/></a></h3>
        <p>manual power setting to limit the maximum draw of the machine</p><h3 id="var/manual_switch"><aside class="declaration">var </aside>manual_switch
            <aside>&ndash; </aside>
        
    
            <a href="https://github.com/Trotskystation/Trotskystation/blob/21b53b49b9515365eab7fd48c7dc12c6bae7cdd2/code/modules/power/energyharvester.dm#L31">
        <img src="git.png" width="16" height="16" title="code&#x2F;modules&#x2F;power&#x2F;energyharvester.dm 31"/></a></h3>
        <p>manual on/off switch</p><h3 id="var/ui_x"><aside class="declaration">var </aside>ui_x
            <aside>&ndash; </aside>
        
    
            <a href="https://github.com/Trotskystation/Trotskystation/blob/21b53b49b9515365eab7fd48c7dc12c6bae7cdd2/code/modules/power/energyharvester.dm#L42">
        <img src="git.png" width="16" height="16" title="code&#x2F;modules&#x2F;power&#x2F;energyharvester.dm 42"/></a></h3>
        <p>tgui width</p><h3 id="var/ui_y"><aside class="declaration">var </aside>ui_y
            <aside>&ndash; </aside>
        
    
            <a href="https://github.com/Trotskystation/Trotskystation/blob/21b53b49b9515365eab7fd48c7dc12c6bae7cdd2/code/modules/power/energyharvester.dm#L44">
        <img src="git.png" width="16" height="16" title="code&#x2F;modules&#x2F;power&#x2F;energyharvester.dm 44"/></a></h3>
        <p>tgui height</p><h2 id="proc">Proc Details</h2><h3 id="proc/attackby">attackby<aside>(/<a href="obj.html">obj</a>/item/I, /<a href="mob.html">mob</a>/user, params) 
        
    
            <a href="https://github.com/Trotskystation/Trotskystation/blob/21b53b49b9515365eab7fd48c7dc12c6bae7cdd2/code/modules/power/energyharvester.dm#L88">
        <img src="git.png" width="16" height="16" title="code&#x2F;modules&#x2F;power&#x2F;energyharvester.dm 88"/></a></aside>
        </h3>
        <p>Standard checks for connecting a machine to an open cable node</p><h3 id="proc/calculateMoney"><aside class="declaration">proc </aside>calculateMoney<aside>() 
        
    
            <a href="https://github.com/Trotskystation/Trotskystation/blob/21b53b49b9515365eab7fd48c7dc12c6bae7cdd2/code/modules/power/energyharvester.dm#L133">
        <img src="git.png" width="16" height="16" title="code&#x2F;modules&#x2F;power&#x2F;energyharvester.dm 133"/></a></aside>
        </h3>
        <ul>
<li>Computes money reward for power transmitted. Balancing goes here.
<ul>
<li>Uses a piecewise function with three defined thresholds and three separate formulas. First linear formula instead of logarithmic so that you don't make </li>
<li>a not insignificant amount of money by charging it with 300W. The other two formulas scale logarithmically and are designed to be balanced against extreme</li>
<li>engine setups such as rad-dupe SMs and fusion TEGs.</li>
</ul>
</li>
</ul><h3 id="proc/connect_to_network"><aside class="declaration">proc </aside>connect_to_network<aside>() 
        
    
            <a href="https://github.com/Trotskystation/Trotskystation/blob/21b53b49b9515365eab7fd48c7dc12c6bae7cdd2/code/modules/power/energyharvester.dm#L57">
        <img src="git.png" width="16" height="16" title="code&#x2F;modules&#x2F;power&#x2F;energyharvester.dm 57"/></a></aside>
        </h3>
        <p>links this to SSeconomy so it can be added to the budget cycle calculations
for when a mapper connects it to the power room roundstart</p>
<ul>
<li>Locates a power node on the turf the harvester is on, then caches a reference to its powernet and queues up in processing
<ul>
<li>Taken from obj/machinery/power which has it natively, but this is an obj/item</li>
</ul>
</li>
</ul><h3 id="proc/disconnect_from_network"><aside class="declaration">proc </aside>disconnect_from_network<aside>() 
        
    
            <a href="https://github.com/Trotskystation/Trotskystation/blob/21b53b49b9515365eab7fd48c7dc12c6bae7cdd2/code/modules/power/energyharvester.dm#L73">
        <img src="git.png" width="16" height="16" title="code&#x2F;modules&#x2F;power&#x2F;energyharvester.dm 73"/></a></aside>
        </h3>
        <ul>
<li>Disconnects from the powernet and sets cached powernet reference to null, then takes it out of processing queue
<ul>
<li>Taken from obj/machinery/power which has it natively, but this is an obj/item</li>
</ul>
</li>
</ul><h3 id="proc/payout"><aside class="declaration">proc </aside>payout<aside>() 
        
    
            <a href="https://github.com/Trotskystation/Trotskystation/blob/21b53b49b9515365eab7fd48c7dc12c6bae7cdd2/code/modules/power/energyharvester.dm#L145">
        <img src="git.png" width="16" height="16" title="code&#x2F;modules&#x2F;power&#x2F;energyharvester.dm 145"/></a></aside>
        </h3>
        <ul>
<li>Actually sends money to the engineering budget. Called exclusively by the SSEconomy subsystem in [economy.dm][/code/controllers/subsystem/economy.dm].
<ul>
<li>Resets accumulated power to 0 and archives payout received and power generated.</li>
</ul>
</li>
</ul><h3 id="proc/process">process<aside>() 
        
    
            <a href="https://github.com/Trotskystation/Trotskystation/blob/21b53b49b9515365eab7fd48c7dc12c6bae7cdd2/code/modules/power/energyharvester.dm#L115">
        <img src="git.png" width="16" height="16" title="code&#x2F;modules&#x2F;power&#x2F;energyharvester.dm 115"/></a></aside>
        </h3>
        <ul>
<li>Checks if machine works or is still attached to a power node, shuts itself down if nonfunctional and takes itself out of processing queue
<ul>
<li>If functional, sucks up all the excess power from the powernet and adds it to the accumulated_power var</li>
<li>Uses REALTIMEOFDAY since that's what SSEconomy runs off. If using regular tick time, a lag spike will slow down the rate of power absorption and thus the money output.</li>
</ul>
</li>
</ul></main>
<footer>
    yogstation.dme
    <a href="https://github.com/Trotskystation/Trotskystation/tree/21b53b49b9515365eab7fd48c7dc12c6bae7cdd2">21b53b4</a>
        (master) &mdash; <a href="https://github.com/SpaceManiac/SpacemanDMM/blob/master/src/dmdoc/README.md">dmdoc 1.2.1</a></footer>
</body>
</html>
